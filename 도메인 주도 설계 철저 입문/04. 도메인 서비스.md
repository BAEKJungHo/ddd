# 부자연스러움을 해결하는 도메인 서비스

소프트웨어 개발에서 말하는 서비스는 클라이언트를 위해 무언가를 해주는 객체를 말한다.

도메인 주도 설계에서 말하는 서비스는 크게 두 가지로 나뉜다.

- 도메인을 위한 서비스
- 애플리케이션을 위한 서비스

## 도메인 서비스란?

도메인 모델 객체(값 객체, 엔티티)에는 객체의 행동을 정의할 수 있다.

그러나 시스템에는 값 객체나 엔티티로 구현하기 어색한 행동도 있다. 도메인 서비스는 이런 어색함을 해결해주는 객체다.

### 값 객체나 엔티티에 정의하기 어색한 행동

예를 들어 사용자 명 중복을 방지해야 한다는 조건이 있다면, 이러한 도메인 규칙을 엔티티에 정의하는게 맞을까?

- 엔티티에 정의한 경우

```java
public class User {
  
  // 사용자 명 중복 확인
  public boolean isExists() {
    // 생략
  }

}
```
```
User user = new User("name", "age");
user.isExists(user);
```

이런식으로 자기 자신에게 묻는 상황이 발생한다.

이러한 부자연스러움을 해결해주는 객체가 `도메인 서비스`이다.

### 부자연스러움을 해결해주는 객체: 도메인 서비스

```java
public class UserService {

  public boolean isExists(User user) {
  
  }
  
}
```

도메인 서비스는 자신의 행동을 바꿀 수 있는 인스턴스만의 값을 갖지 않는다는 점에서 엔티티와 다르다.

### 도메인 서비스를 남용한 결과

모든 처리를(Ex. 사용자명 수정 등) 도메인 서비스에 구현하면 엔티티는 게터 세터만 남게 된다. 이렇게 되면 개발자가 도메인 규칙을 발견하기 어렵다. 

생각 없이 모든 처리 코드를 도메인 서비스로 옮기면 다른 도메인 객체는 그저 데이터를 저장할 뿐, 별다른 정보를 제공할 수 없는 객체가 되는 결과를 낳는다.

도메인 객체가 원래 포함했어야 할 지식이나 처리 내용을 모두 서비스나 애플리케이션에서 담당하게 되면 이러한 도메인 객체를 `빈혈 도메인 모델`이라고 한다.

### 도메인 서비스에 엔티티의 행동을 바꿀 수 있는 코드를 최대한 제거

엔티티의 행동을 바꿀 수 있는 코드가 도메인 모델 객체나 도메인 서비스에 흩어져있으면, 도메인 규칙을 파악하기도 어렵고 중복 코드 발생의 위험도 있다. 또한 데이터와 행위가 단절되기도 한다.

## 도메인 서비스 기준

책의 저자는 어떤 처리를 도메인 서비스로 만들어야 할지를 판단할 때 그 처리가 도메인에 기초한 것인지를 중요하게 본다고 한다. '사용자명 중복'이라는 개념이 도메인에 기초한 것이면
도메인 서비스로 만들고, 애플리케이션 개발 과정에서 필요에 의해 만들어진 개념이면 애플리케이션 서비스로 정의해야 한다고 한다.

그리고 입출력을 가능한 한 도메인 서비스로 다루지 말아야 한다고 한다.

## 도메인 서비스에 이름을 붙이는 규칙

- 도메인 개념
- `추천 : 도메인 개념 + Service`
  - 도메인 서비스도 자체의 서비스이고, 엔티티를 만들때 엔티티명+Domain 이런식으로는 짓지 않기 때문이다.
- 도메인 개념 + DomainService








