# 밸리데이터와 명세

## Validator 에서 도메인 로직, 비지니스 로직을 가지고 있어도 되는지 ?

스프링에서 유효성 검증을 위해 `JSR-303` 기반 어노테이션을 DTO 에 적용하거나, 아니면 Validator 를 만들어서 유효성 검증을 실시하는데, 
유효성 검증이라는 것이 데이터베이스 제약조건과도 연관있고, 화면 폼과도 연관있지만 계층형 아키텍처로 따졌을때는 `프레젠테이션 계층(Presentation Layer)` 에 속한다고 생각합니다.

> 따라서, Validator 는 web 패키지(controller 와 같은 패키지)에 속하는게 맞다고 생각하고, web 아래 패키지에 validator 패키지를 두는게 맞다고 생각.

그 이유는 화면에서 입력한 값들에 대해 유효성 검증을 실시하기 때문이고(__데이터베이스 제약조건과는 별개로 화면과 연관되어 처리되어야 하는 유효성 검증이 있을 수도 있다고 생각__) 컨트롤러에서 처리되기 때문이라 그렇게 생각합니다. 

`JSR-303` 기반의 어노테이션 유효성 검증을 하게 되는 경우에는 프레젠테이션 계층(컨트롤러 단)에 비지니스 로직이 노출되지 않기 때문에, `도메인 로직`을 `엔티티, 도메인서비스 혹은 명세`에 모아둠으로써
도메인 로직들이 흩어지지 않게 해준다고 생각합니다. JSR-303 기반의 어노테이션으로 유효성 검증을 하게 되면 DTO 가 너무 지저분해지는게 싫어서 Validator 라는 클래스를 만들어 사용하기도 합니다.

예를들어, 가맹점 신청이라는 것을 개발할때 사업자번호, 업체정보등을 입력 후 등록할때 각 입력폼에 대한 유효성 검증을 하고, `사업자번호로 이미 등록되어있는 데이터가 있는지 확인(즉, 서비스 호출해서 조회하는 로직 필요)`
이러한 경우에 저 서비스 호출하는 부분은 __서비스에서 처리하는게 맞는 것인지 아니면 Validator 에 저러한 검증 로직을 노출 시켜도 되는 부분인지__ 에 대한 제 생각은 다음과 같습니다.

제 생각은 JSR-303 기반 어노테이션으로 유효성 검증이 가능한 부분은 Validator 로 빼야하는 것이 맞다고 생각하고, 도메인 로직에 속하는 부분은 최대한 엔티티나 명세로 빼내야 하는게 맞다고 생각합니다.

따라서, 가장 정석적인 방식은 __Validator 에서는 비지니스로직을 노출 시키지 않고, 간단한 유효성 검증만을 실시하며, 데이터스토어를 조회하는 로직의 경우, 도메인 서비스 부분에서 엔티티나 명세를 이용하는 것이 바람직 하다고 생각합니다.__ 

Validator 에서 도메인 로직들을 노출 시키면, 도메인 로직들이 이리저리 흩어지기 때문에 응집력이 낮아진다고 생각합니다. 

## 패키지 

내가 생각하기에 이상적인 패키지 분리방식은 다음과 같다.

- `domain package`
  - `dto package`
    - dto files
  - `entities files or enum files`
    - 엔티티안에 Enum 을 포함 시킬 수 있다. 
    - 예를 들어, 가맹점 신청 시, 신청 타입이라는 Enum 이 있을 때, Enum class 를 밖으로 빼두면, 어떤 엔티티에 대한 신청타입인지 잘 모를 수가 있음. 물론, 엔티티에서 Enum 클래스를 필드로 갖는다면 쉽게 알 수 있지만, 서로 연관있는 엔티티에 Enum 을 만듦으로써 응집력을 높일 수 있지 않나 생각 함.
  - `specification package`
    - specification files
- `repository package`
  - repository files
- `service package`
  - xxxFindService files
  - xxxService files
- `web package`
  - `validator package`
    - validator files
  - controller files



